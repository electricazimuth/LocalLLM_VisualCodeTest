<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Aquarium Simulation</title>
    <style>
        html,body{margin:0;height:100%;overflow:hidden;background:#e0f7fa}
        canvas{
            display:block;
            margin:auto;
            background:#cfeffb;               /* water colour */
            border:1px solid #888;
        }
    </style>
</head>
<body>
    <canvas id="simulationCanvas"></canvas>

    <script>
        /* -------------------------------------------------------------
           Simple aquarium simulation – pure Canvas + vanilla JavaScript
           ------------------------------------------------------------- */

        /* -------------------------------------------------------------
           Canvas & global helpers
        ------------------------------------------------------------- */
        const canvas = document.getElementById('simulationCanvas');
        const ctx    = canvas.getContext('2d');

        // make canvas fill the window (but keep a nice aspect ratio)
        function resize() {
            const w = window.innerWidth;
            const h = window.innerHeight;
            // keep a 4:3 ratio – you can change this if you like
            if (w / h > 4/3) {
                canvas.height = h;
                canvas.width  = h * 4/3;
            } else {
                canvas.width  = w;
                canvas.height = w * 3/4;
            }
        }
        window.addEventListener('resize', resize);
        resize();

        const W = () => canvas.width;
        const H = () => canvas.height;

        /* -------------------------------------------------------------
           Utility functions
        ------------------------------------------------------------- */
        const rand = (a,b) => Math.random()*(b-a)+a;
        const deg2rad = d => d*Math.PI/180;
        const rad2deg = r => r*180/Math.PI;
        const clamp = (v,min,max)=> Math.max(min, Math.min(max,v));

        /* -------------------------------------------------------------
           Fish class – encapsulates state & behaviour
        ------------------------------------------------------------- */
        class Fish {
            constructor() {
                // size influences speed and drawing
                this.size   = rand(15,30);               // radius of body
                this.x      = rand(this.size, W()-this.size);
                this.y      = rand(this.size, H()-this.size);
                this.speed  = rand(30,80);               // pixels per second
                this.angle  = rand(0, Math.PI*2);        // direction of movement
                this.color  = `hsl(${rand(0,360)},70%,55%)`;
                this.wanderTimer = 0;                    // time until next random turn
                this.tailPhase = Math.random()*Math.PI*2; // for tail wiggle
            }

            // ---------------------------------------------------------
            // update position / direction
            // dt – time since last frame in seconds
            // ---------------------------------------------------------
            update(dt){
                // ---- wandering ----
                this.wanderTimer -= dt;
                if (this.wanderTimer <= 0){
                    // pick a small random change in direction
                    const delta = deg2rad(rand(-30,30));
                    this.angle += delta;
                    // next change in 1‑3 seconds
                    this.wanderTimer = rand(1,3);
                }

                // ---- boundary steering ----
                const margin = 50;               // start turning before the wall
                const turnSpeed = deg2rad(120);  // how fast we can turn (rad/s)

                // vector towards centre when too close to a wall
                let steer = 0;
                if (this.x < margin)          steer += turnSpeed*dt;
                else if (this.x > W()-margin) steer -= turnSpeed*dt;
                if (this.y < margin)          steer += turnSpeed*dt;
                else if (this.y > H()-margin) steer -= turnSpeed*dt;

                // apply steering (smooth turn)
                this.angle += steer;

                // ---- move ----
                const vx = Math.cos(this.angle) * this.speed;
                const vy = Math.sin(this.angle) * this.speed;
                this.x += vx * dt;
                this.y += vy * dt;

                // keep inside the canvas (clamp) – just in case numerical drift
                this.x = clamp(this.x, this.size, W()-this.size);
                this.y = clamp(this.y, this.size, H()-this.size);

                // ---- tail animation ----
                this.tailPhase += dt * 10; // fast wiggle
            }

            // ---------------------------------------------------------
            // draw the fish – oriented to its movement direction
            // ---------------------------------------------------------
            draw(ctx){
                ctx.save();
                ctx.translate(this.x, this.y);
                ctx.rotate(this.angle);

                // body
                ctx.fillStyle = this.color;
                ctx.beginPath();
                ctx.ellipse(0,0,this.size*1.2,this.size,0,0,Math.PI*2);
                ctx.fill();

                // tail (simple triangle that wiggles)
                const tailWiggle = Math.sin(this.tailPhase)*deg2rad(15);
                ctx.save();
                ctx.translate(-this.size*1.2,0);
                ctx.rotate(tailWiggle);
                ctx.beginPath();
                ctx.moveTo(0,0);
                ctx.lineTo(-this.size*0.8, this.size*0.6);
                ctx.lineTo(-this.size*0.8,-this.size*0.6);
                ctx.closePath();
                ctx.fill();
                ctx.restore();

                // eye (small white dot)
                ctx.fillStyle = '#fff';
                ctx.beginPath();
                ctx.arc(this.size*0.4, -this.size*0.2, this.size*0.12,0,Math.PI*2);
                ctx.fill();

                ctx.restore();
            }
        }

        /* -------------------------------------------------------------
           Create a school of fish
        ------------------------------------------------------------- */
        const FISH_COUNT = 12;
        const fishSchool = [];
        for(let i=0;i<FISH_COUNT;i++) fishSchool.push( new Fish() );

        /* -------------------------------------------------------------
           Simple background – a few plants at the bottom
        ------------------------------------------------------------- */
        function drawBackground(ctx){
            // water gradient (optional)
            const grad = ctx.createLinearGradient(0,0,0,H());
            grad.addColorStop(0,'#cfeffb');
            grad.addColorStop(1,'#a0d8ef');
            ctx.fillStyle = grad;
            ctx.fillRect(0,0,W(),H());

            // seabed
            const seabedHeight = H()*0.12;
            ctx.fillStyle = '#b5a16c';
            ctx.fillRect(0, H()-seabedHeight, W(), seabedHeight);

            // simple plants
            const plantCount = 8;
            for(let i=0;i<plantCount;i++){
                const x = (i+0.5)*(W()/plantCount);
                const yBase = H()-seabedHeight;
                const plantHeight = rand(40,80);
                ctx.strokeStyle = '#2e7d32';
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.moveTo(x, yBase);
                ctx.quadraticCurveTo(x-rand(-20,20), yBase-plantHeight/2,
                                      x, yBase-plantHeight);
                ctx.stroke();
            }
        }

        /* -------------------------------------------------------------
           Main animation loop – requestAnimationFrame with delta time
        ------------------------------------------------------------- */
        let lastTimestamp = 0;
        function gameLoop(timestamp){
            const dt = (timestamp - lastTimestamp) / 1000; // seconds
            lastTimestamp = timestamp;

            // ---- update ----
            fishSchool.forEach(f=>f.update(dt));

            // ---- draw ----
            drawBackground(ctx);
            fishSchool.forEach(f=>f.draw(ctx));

            requestAnimationFrame(gameLoop);
        }

        // start the loop
        requestAnimationFrame(t=>{ lastTimestamp = t; gameLoop(t); });
    </script>
</body>
</html>