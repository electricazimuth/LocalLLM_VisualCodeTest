<!DOCTYPE html>
<html>
<head>
    <title>Happy Mrs. Chicken Simulation</title>
    <style>
        body {
            margin: 10px;
            overflow: hidden;
            background-color: #f0f8f0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        canvas {
            display: block;
            margin: 20px auto;
            border: 1px solid #999;
            background-color: #90ee90; /* Light green grass background */
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 15px;
        }
        button {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }
        .stats {
            text-align: center;
            margin-top: 10px;
            font-size: 18px;
            color: #333;
        }
    </style>
</head>
<body>
    <canvas id="simulationCanvas" width="800" height="600"></canvas>
    
    <div class="controls">
        <button id="startBtn">Start Simulation</button>
        <button id="resetBtn">Reset</button>
        <button id="pauseBtn">Pause</button>
    </div>
    
    <div class="stats">
        Eggs Laid: <span id="eggCount">0</span> | 
        Chicken State: <span id="stateIndicator">Wandering</span>
    </div>

    <script>
        // Chicken class
        class Chicken {
            constructor(canvas) {
                this.canvas = canvas;
                this.ctx = canvas.getContext('2d');
                this.width = canvas.width;
                this.height = canvas.height;
                
                // Initial position and properties
                this.x = this.width / 2;
                this.y = this.height / 2;
                this.size = 40;
                this.speed = 1.5;
                this.direction = Math.random() * Math.PI * 2;
                this.state = 'wandering'; // wandering, laying, resting
                this.layTimer = 0;
                this.layDuration = 1500; // 1.5 seconds
                this.restDuration = 1000; // 1 second
                this.restTimer = 0;
                this.eggCount = 0;
                
                // Visual properties
                this.bodyColor = '#F5DEB3'; // Beige
                this.combColor = '#CD5C5C'; // Indian red
                this.beakColor = '#D2B48C'; // Tan
                this.eyeColor = '#4682B4'; // Steel blue
            }
            
            update(deltaTime) {
                // Update timers
                this.layTimer += deltaTime;
                this.restTimer += deltaTime;
                
                // State machine
                switch(this.state) {
                    case 'wandering':
                        // Move in current direction
                        this.x += Math.cos(this.direction) * this.speed * deltaTime;
                        this.y += Math.sin(this.direction) * this.speed * deltaTime;
                        
                        // Bounce off edges
                        if (this.x < this.size || this.x > this.width - this.size) {
                            this.direction = Math.PI - this.direction;
                        }
                        if (this.y < this.size || this.y > this.height - this.size) {
                            this.direction = -this.direction;
                        }
                        
                        // Random direction changes
                        if (Math.random() < 0.002 * deltaTime) {
                            this.direction += (Math.random() - 0.5) * Math.PI;
                        }
                        
                        // Check if it's time to lay an egg
                        if (this.layTimer > 5000) { // Every 5 seconds
                            this.state = 'laying';
                            this.layTimer = 0;
                        }
                        break;
                        
                    case 'laying':
                        // Pause movement
                        this.state = 'resting';
                        this.layTimer = 0;
                        this.eggCount++;
                        document.getElementById('eggCount').textContent = this.eggCount;
                        break;
                        
                    case 'resting':
                        // Chicken is resting after laying
                        if (this.restTimer > this.restDuration) {
                            this.state = 'wandering';
                            this.restTimer = 0;
                        }
                        break;
                }
                
                // Update state indicator
                document.getElementById('stateIndicator').textContent = 
                    this.state.charAt(0).toUpperCase() + this.state.slice(1);
            }
            
            draw() {
                this.ctx.save();
                this.ctx.translate(this.x, this.y);
                this.ctx.rotate(this.direction - Math.PI/2);
                
                // Draw body
                this.ctx.beginPath();
                this.ctx.arc(0, 0, this.size, 0, Math.PI * 2);
                this.ctx.fillStyle = this.bodyColor;
                this.ctx.fill();
                
                // Draw comb
                this.ctx.beginPath();
                this.ctx.moveTo(-this.size * 0.7, -this.size * 0.3);
                this.ctx.lineTo(-this.size * 0.5, -this.size * 0.7);
                this.ctx.lineTo(this.size * 0.5, -this.size * 0.5);
                this.ctx.lineTo(this.size * 0.7, -this.size * 0.3);
                this.ctx.closePath();
                this.ctx.fillStyle = this.combColor;
                this.ctx.fill();
                
                // Draw head
                this.ctx.beginPath();
                this.ctx.arc(this.size * 0.8, 0, this.size * 0.3, 0, Math.PI * 2);
                this.ctx.fillStyle = this.bodyColor;
                this.ctx.fill();
                
                // Draw beak
                this.ctx.beginPath();
                this.ctx.moveTo(this.size * 0.9, 0);
                this.ctx.lineTo(this.size * 1.1, -this.size * 0.2);
                this.ctx.lineTo(this.size * 1.1, this.size * 0.2);
                this.ctx.closePath();
                this.ctx.fillStyle = this.beakColor;
                this.ctx.fill();
                
                // Draw eye
                this.ctx.beginPath();
                this.ctx.arc(this.size * 0.85, -this.size * 0.1, this.size * 0.1, 0, Math.PI * 2);
                this.ctx.fillStyle = this.eyeColor;
                this.ctx.fill();
                
                // Draw pupil
                this.ctx.beginPath();
                this.ctx.arc(this.size * 0.88, -this.size * 0.05, this.size * 0.05, 0, Math.PI * 2);
                this.ctx.fillStyle = '#000';
                this.ctx.fill();
                
                this.ctx.restore();
            }
        }
        
        // Egg class
        class Egg {
            constructor(x, y, canvas) {
                this.x = x;
                this.y = y;
                this.size = 30;
                this.age = 0;
                this.maxAge = 10000; // 10 seconds
                this.ctx = canvas.getContext('2d');
            }
            
            update(deltaTime) {
                this.age += deltaTime;
                if (this.age > this.maxAge) return false;
                return true;
            }
            
            draw() {
                this.ctx.beginPath();
                this.ctx.ellipse(this.x, this.y, this.size * 0.8, this.size, 0, 0, Math.PI * 2);
                this.ctx.fillStyle = '#FDF5E6'; // Old lace
                this.ctx.fill();
                
                // Draw shell texture
                this.ctx.beginPath();
                for (let i = 0; i < 20; i++) {
                    const angle = i * Math.PI / 10;
                    const radius = this.size * 0.4 + Math.random() * this.size * 0.2;
                    const x = this.x + radius * Math.cos(angle);
                    const y = this.y + radius * Math.sin(angle);
                    this.ctx.lineTo(x, y);
                }
                this.ctx.closePath();
                this.ctx.strokeStyle = '#F5F5DC'; // Beige
                this.ctx.stroke();
                
                // Draw yolk
                this.ctx.beginPath();
                this.ctx.arc(this.x, this.y, this.size * 0.3, 0, Math.PI * 2);
                this.ctx.fillStyle = '#FFD700'; // Gold
                this.ctx.fill();
            }
        }
        
        // Main simulation
        function main() {
            const canvas = document.getElementById('simulationCanvas');
            const chicken = new Chicken(canvas);
            let eggs = [];
            let lastTime = null;
            let isRunning = false;
            
            // Start simulation
            document.getElementById('startBtn').addEventListener('click', () => {
                isRunning = true;
                document.getElementById('startBtn').disabled = true;
                document.getElementById('resetBtn').disabled = false;
                document.getElementById('pauseBtn').disabled = false;
                lastTime = performance.now();
                animate();
            });
            
            // Reset simulation
            document.getElementById('resetBtn').addEventListener('click', () => {
                eggs = [];
                chicken.eggCount = 0;
                document.getElementById('eggCount').textContent = 0;
                document.getElementById('startBtn').disabled = false;
                document.getElementById('resetBtn').disabled = true;
                document.getElementById('pauseBtn').disabled = true;
                isRunning = false;
            });
            
            // Pause simulation
            document.getElementById('pauseBtn').addEventListener('click', () => {
                isRunning = !isRunning;
                document.getElementById('pauseBtn').textContent = isRunning ? 'Pause' : 'Resume';
            });
            
            function animate() {
                if (!isRunning) return;
                
                const now = performance.now();
                const deltaTime = now - lastTime;
                lastTime = now;
                
                // Update chicken
                chicken.update(deltaTime);
                
                // Update eggs
                eggs = eggs.filter(egg => egg.update(deltaTime));
                
                // Add egg when chicken is laying
                if (chicken.state === 'resting') {
                    eggs.push(new Egg(chicken.x, chicken.y, canvas));
                }
                
                // Draw everything
                drawScene();
                
                requestAnimationFrame(animate);
            }
            
            function drawScene() {
                // Clear canvas
                chicken.ctx.clearRect(0, 0, chicken.width, chicken.height);
                
                // Draw background
                chicken.ctx.fillStyle = '#90ee90'; // Light green
                chicken.ctx.fillRect(0, 0, chicken.width, chicken.height);
                
                // Draw sun
                chicken.ctx.fillStyle = '#FFD700'; // Gold
                chicken.ctx.beginPath();
                chicken.ctx.arc(700, 50, 50, 0, Math.PI * 2);
                chicken.ctx.fill();
                
                // Draw grass
                chicken.ctx.fillStyle = '#6B8E23'; // Olive drab
                chicken.ctx.fillRect(0, 550, 800, 50);
                
                // Draw chicken
                chicken.draw();
                
                // Draw eggs
                eggs.forEach(egg => egg.draw());
            }
            
            // Initial draw
            drawScene();
        }
        
        // Start when page loads
        window.addEventListener('load', main);
    </script>
</body>
</html>